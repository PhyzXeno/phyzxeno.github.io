<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Still water runs deep."><title>Python3中的正则表达式 | PhyzX</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Python3中的正则表达式</h1><a id="logo" href="/.">PhyzX</a><p class="description">The quieter you become, the more you will hear.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Python3中的正则表达式</h1><div class="post-meta">Apr 17, 2017<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>趟过了网上各种大坑之后，我希望简单地写两个Python3的正则表达式小例子，区别几个函数的用法。</p>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>由于扫描器需要，所以我想把一个网页上所有的URL提取出来。</p>
<p>首先，我下载一个网页的源代码，里面有一些URL：</p>
<p><img src="\img\pythonReg\2017-04-17_111243.png" alt=""></p>
<p>可见，基本都是”&lt;a href=”开头的，所以如果把以这个开头的都提取出来，获取URL就方便了。</p>
<p>于是我们采用正则表达式，这里我们使用两种方法进行正则匹配：</p>
<h4 id="方法一-使用findall函数"><a href="#方法一-使用findall函数" class="headerlink" title="方法一 使用findall函数"></a>方法一 使用findall函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">import re</div><div class="line"></div><div class="line"># 以utf-8编码，只读模式打开一个html源代码</div><div class="line">file = open(&apos;view-source_www.sinomach.com.cn.html&apos;,&apos;r&apos;,encoding=&apos;utf-8&apos;)    </div><div class="line"></div><div class="line"># 使用findall函数来进行正则匹配</div><div class="line">abc = re.findall(r&apos;&lt;a href=&quot;.*?&quot;&apos;, file.read()) </div><div class="line"></div><div class="line"># 结果一个个打印出来</div><div class="line">for i in range(len(abc)):</div><div class="line">    print(abc[i])</div></pre></td></tr></table></figure>
<p>解释几点：</p>
<ol>
<li>使用open函数后，打开的是一个文件对象，我们可以使用print(type(file))来看一下，运行后可看到：file为<class '_io.textiowrapper'="">这种类型。</class></li>
<li>file.read()后成为“str”类型。这里多说一句，file.read()后，指针就指到file对象的末尾了，你再在程序的其他位置使用file.read()就啥也读不出来了，所以建议及时把file.read()赋值给一个变量。</li>
<li>然后findall()函数的第一个参数，<code>r&#39;&lt;a href=&quot;.*?&quot;&#39;</code>，这个是具体的正则表达式由<code>r&#39;&#39;</code>引上的原因是r单引号中引上的东西是raw的：反斜杠就是反斜杠，不会转义，写啥就是啥。具体正则的含义就是，匹配以<code>&lt;a href=&quot;</code>开头的，以<code>&quot;</code>结尾的，中间按照正则规则<code>.*?</code>进行匹配的字符串。这里<code>.*?</code>是按照非贪婪模式匹配，如果想用贪婪模式的话，就是<code>.*</code>，这两个区别就是<code>*</code>匹配字符的多少，非贪婪就是尽量往少了匹配，贪婪就是尽量往多了匹配。</li>
<li>file.read()是将这个文件变为“一个”字符串，他的类型是<code>str</code>；而file.readlines()是将文件按行取出，作为一个list，list的每一个元素都是<code>str</code>类型。</li>
<li>re.findall()的结果也是一个list。</li>
</ol>
<p>该程序最终输出结果：</p>
<p><img src="\img\pythonReg\2017-04-17_122919.png" alt=""></p>
<h4 id="方法二-使用search函数"><a href="#方法二-使用search函数" class="headerlink" title="方法二 使用search函数"></a>方法二 使用search函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">import re</div><div class="line"></div><div class="line"># 显示一个对象的类型</div><div class="line">def printType(a):</div><div class="line">    print(type(a))                                                                 </div><div class="line"></div><div class="line"># 打印出正则匹配结果</div><div class="line">def printReg(pattern, string):</div><div class="line">    match = re.compile(pattern).search(string).group()</div><div class="line">    print(match)</div><div class="line"></div><div class="line"># 正则表达式</div><div class="line">pattern = &apos;&lt;a href=&quot;.*?&quot;&apos;</div><div class="line"></div><div class="line"># 打开文件</div><div class="line">file = open(&apos;view-source_www.sinomach.com.cn.html&apos;,&apos;r&apos;,encoding=&apos;utf-8&apos;)</div><div class="line"></div><div class="line"># 按行读取成list</div><div class="line">lists = file.readlines()</div><div class="line"></div><div class="line"># 输出匹配结果</div><div class="line">for i in range(len(lists)):</div><div class="line">    try:</div><div class="line">        printReg(pattern, lists[i])</div><div class="line">    except:</div><div class="line">        pass</div><div class="line"></div><div class="line">#关闭文件</div><div class="line">file.close()</div></pre></td></tr></table></figure>
<p>几点说明：</p>
<ol>
<li>pattern里面写着正则表达式。</li>
<li>接下来三点主要围绕这句介绍：<code>match = re.compile(pattern).search(string).group()</code></li>
<li>我们需要对正则表达式进行<code>compile</code>，生成一个模式对象，然后再使用该对象来匹配我们的目标string。</li>
<li>模式对象下有几个方法<code>match()</code>; <code>fullmatch()</code>; <code>search()</code> 。我一上午都在使用网上铺天盖地的<code>match</code>方法，结果查手册才知道，match只会从string的开头去匹配，如果要匹配string的任意位置，则需要使用<code>search</code>。另外，<code>fullmatch</code>要求更严，string得完全符合模式对象的正则匹配，才能有结果。具体文档如下：<img src="\img\pythonReg\1.png" alt=""></li>
<li>search过后，使用group进行结果输出。</li>
</ol>
<p>该程序最终执行结果如下：</p>
<p><img src="\img\pythonReg\2017-04-17_124507.png" alt=""></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://phyzxeno.github.io/2017/04/17/pythonReg/" data-id="cj346fz550004o8vhyobmbz6r" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Python/">Python</a></div><div class="post-nav"><a href="/2017/05/18/GotPlt/" class="pre">Linux中的GOT和PLT到底是个啥？</a><a href="/2017/03/30/LinuxRedirect/" class="next">Linux重定向简单介绍</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://phyzxeno.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/常识/" style="font-size: 15px;">常识</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/Web渗透/" style="font-size: 15px;">Web渗透</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/18/GotPlt/">Linux中的GOT和PLT到底是个啥？</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/17/pythonReg/">Python3中的正则表达式</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/30/LinuxRedirect/">Linux重定向简单介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/30/ssrf/">SSRF漏洞经典案例</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/crlf/">CR和LF区别和关系</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://linanjun525.github.io" title="linanjun525" target="_blank">linanjun525</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">PhyzX.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>